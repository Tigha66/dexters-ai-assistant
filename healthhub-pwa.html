<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthHub - Your Health Companion</title>
    <meta name="theme-color" content="#10b981">
    <meta name="description" content="Your personal health companion">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--primary:#10b981;--primary-dark:#059669;--secondary:#3b82f6;--danger:#ef4444;--warning:#f59e0b;--gray-50:#f9fafb;--gray-100:#f3f4f6;--gray-200:#e5e7eb;--gray-300:#d1d5db;--gray-400:#9ca3af;--gray-500:#6b7280;--gray-600:#4b5563;--gray-700:#374151;--gray-800:#1f2937}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--gray-50);min-height:100vh}
        .header{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;padding:1.5rem;position:sticky;top:0;z-index:100}
        .header h1{font-size:1.5rem;font-weight:700}
        .user-info{display:flex;align-items:center;gap:0.5rem;margin-top:0.5rem}
        .avatar{width:32px;height:32px;border-radius:50%;background:white;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--primary)}
        .tab-bar{position:fixed;bottom:0;left:0;right:0;background:white;border-top:1px solid var(--gray-200);display:flex;justify-content:space-around;padding:0.5rem;z-index:97}
        .tab-item{display:flex;flex-direction:column;align-items:center;padding:0.5rem;color:var(--gray-500);font-size:0.625rem;cursor:pointer}
        .tab-item.active{color:var(--primary)}
        .tab-icon{font-size:1.25rem;margin-bottom:0.25rem}
        .main{padding:1rem;max-width:600px;margin:0 auto;padding-bottom:70px}
        .section{display:none}
        .section.active{display:block}
        .card{background:white;border-radius:12px;padding:1.25rem;margin-bottom:1rem;box-shadow:0 1px 3px rgba(0,0,0,0.1)}
        .card-title{font-size:1.125rem;font-weight:600;color:var(--gray-800);margin-bottom:1rem}
        .stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0.5rem;margin-bottom:1rem}
        .stat-card{background:white;border-radius:12px;padding:0.75rem;text-align:center}
        .stat-value{font-size:1.5rem;font-weight:700;color:var(--primary)}
        .stat-label{font-size:0.625rem;color:var(--gray-500);text-transform:uppercase}
        .btn{padding:0.75rem 1.5rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;width:100%}
        .btn-primary{background:var(--primary);color:white}
        .btn-secondary{background:var(--gray-100);color:var(--gray-700)}
        .btn-small{width:auto;padding:0.5rem 1rem;font-size:0.875rem}
        .quick-actions{display:grid;grid-template-columns:repeat(4,1fr);gap:0.5rem;margin-bottom:1rem}
        .quick-action{background:white;border-radius:12px;padding:1rem 0.5rem;text-align:center;cursor:pointer;border:none}
        .quick-action-icon{font-size:1.5rem}
        .quick-action-label{font-size:0.625rem;color:var(--gray-600);margin-top:0.25rem}
        .med-item{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:var(--gray-50);border-radius:8px;margin-bottom:0.75rem}
        .med-info h4{font-size:1rem}
        .med-info p{font-size:0.75rem;color:var(--gray-500)}
        .status-dot{width:24px;height:24px;border-radius:50%;border:3px solid var(--gray-300);cursor:pointer;transition:all 0.2s}
        .status-dot.taken{background:var(--primary);border-color:var(--primary)}
        .appt-card{background:var(--gray-50);border-radius:8px;padding:1rem;margin-bottom:0.75rem;border-left:4px solid var(--secondary)}
        .appt-date{font-weight:600}
        .appt-type{font-size:0.875rem;color:var(--gray-500)}
        .record-item{padding:1rem;background:var(--gray-50);border-radius:8px;margin-bottom:0.75rem}
        .record-type{font-size:0.625rem;color:var(--gray-500);text-transform:uppercase}
        .record-title{font-weight:600;margin:0.25rem 0}
        .record-date{font-size:0.75rem;color:var(--gray-500)}
        .metric{display:flex;justify-content:space-between;padding:0.75rem 0;border-bottom:1px solid var(--gray-100)}
        .badge{padding:0.25rem 0.5rem;border-radius:12px;font-size:0.625rem;font-weight:600}
        .badge-good{background:#d1fae5;color:var(--primary)}
        .badge-warning{background:#fef3c7;color:var(--warning)}
        .chart{height:120px;background:var(--gray-50);border-radius:8px;padding:1rem;display:flex;align-items:flex-end;justify-content:space-around;gap:4px}
        .bar{width:20px;background:var(--primary);border-radius:4px 4px 0 0;position:relative}
        .bar::after{content:attr(data-v);position:absolute;top:-18px;left:50%;transform:translateX(-50%);font-size:0.5rem;color:var(--gray-600)}
        .form-group{margin-bottom:1rem}
        .form-label{display:block;font-size:0.875rem;font-weight:500;margin-bottom:0.5rem}
        .form-input,.form-select,.form-textarea{width:100%;padding:0.75rem;border:1px solid var(--gray-300);border-radius:8px}
        .modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;padding:1rem}
        .modal-overlay.active{display:flex}
        .modal{background:white;border-radius:16px;width:100%;max-width:400px;max-height:90vh;overflow-y:auto}
        .modal-header{padding:1rem;border-bottom:1px solid var(--gray-200);display:flex;justify-content:space-between}
        .modal-title{font-weight:600}
        .modal-close{background:none;border:none;font-size:1.5rem;cursor:pointer}
        .modal-body{padding:1rem}
        .modal-footer{padding:1rem;border-top:1px solid var(--gray-200);display:flex;gap:0.5rem}
        .login{position:fixed;inset:0;background:white;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center;z-index:999}
        .login-logo{font-size:4rem;margin-bottom:1rem}
        .login h1{font-size:2rem;margin-bottom:0.5rem}
        .login p{color:var(--gray-500);margin-bottom:2rem}
        .pwa-banner{display:none;background:var(--secondary);color:white;padding:0.75rem;text-align:center;cursor:pointer}
        .pwa-banner.show{display:block}
    </style>
</head>
<body>
    <div class="pwa-banner" id="pwaBanner" onclick="installPWA()">üì≤ Tap to install HealthHub</div>
    <div class="login" id="login">
        <div class="login-logo">üè•</div>
        <h1>HealthHub</h1>
        <p>In Control. Healthier. Happier.</p>
        <div style="width:100%;max-width:280px">
            <input type="email" class="form-input" placeholder="Email" id="email" style="margin-bottom:0.5rem">
            <input type="password" class="form-input" placeholder="Password" id="password" style="margin-bottom:0.5rem">
            <button class="btn btn-primary" onclick="login()">Sign In</button>
            <button class="btn btn-secondary" style="margin-top:0.5rem" onclick="guest()">Continue as Guest</button>
        </div>
    </div>
    <div id="app" style="display:none">
        <div class="header">
            <h1>üè• HealthHub</h1>
            <div class="user-info"><div class="avatar" id="avatar">G</div><span id="userName">Guest</span></div>
        </div>
        <main class="main">
            <section id="dashboard" class="section active">
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-value" id="sAppt">0</div><div class="stat-label">Appts</div></div>
                    <div class="stat-card"><div class="stat-value" id="sMeds">0</div><div class="stat-label">Meds</div></div>
                    <div class="stat-card"><div class="stat-value" id="sPill">--</div><div class="stat-label">% Taken</div></div>
                    <div class="stat-card"><div class="stat-value" id="sRec">0</div><div class="stat-label">Records</div></div>
                </div>
                <div class="card"><div class="card-title">Quick Actions</div>
                    <div class="quick-actions">
                        <button class="quick-action" onclick="open('appt')"><div class="quick-action-icon">üìÖ</div><div class="quick-action-label">Book</div></button>
                        <button class="quick-action" onclick="open('rx')"><div class="quick-action-icon">üíä</div><div class="quick-action-label">Rx</div></button>
                        <button class="quick-action" onclick="open('measure')"><div class="quick-action-icon">üìä</div><div class="quick-action-label">Measure</div></button>
                        <button class="quick-action" onclick="open('rec')"><div class="quick-action-icon">üìÑ</div><div class="quick-action-label">Record</div></button>
                    </div>
                </div>
                <div class="card"><div class="card-title">Today's Medications</div><div id="todayMeds"></div></div>
                <div class="card"><div class="card-title">BP Trend (7 days)</div><div class="chart" id="bpChart"></div></div>
            </section>
            <section id="meds" class="section">
                <div class="card"><div class="card-title">My Medications<button class="btn btn-primary btn-small" style="float:right" onclick="open('med')">+</button></div><div id="allMeds"></div></div>
            </section>
            <section id="appts" class="section">
                <div class="card"><div class="card-title">Upcoming<button class="btn btn-primary btn-small" style="float:right" onclick="open('appt')">+</button></div><div id="upAppts"></div></div>
            </section>
            <section id="records" class="section">
                <div class="card"><div class="card-title">Medical Records<button class="btn btn-primary btn-small" style="float:right" onclick="open('rec')">+</button></div><div id="allRecs"></div></div>
            </section>
            <section id="health" class="section">
                <div class="card"><div class="card-title">Health Metrics<button class="btn btn-primary btn-small" style="float:right" onclick="open('measure')">+</button></div><div id="healthMet"></div></div>
            </section>
        </main>
        <div class="tab-bar">
            <div class="tab-item active" onclick="show('dashboard')"><span class="tab-icon">üè†</span>Home</div>
            <div class="tab-item" onclick="show('meds')"><span class="tab-icon">üíä</span>Meds</div>
            <div class="tab-item" onclick="show('appts')"><span class="tab-icon">üìÖ</span>Appts</div>
            <div class="tab-item" onclick="show('records')"><span class="tab-icon">üìÑ</span>Records</div>
            <div class="tab-item" onclick="show('health')"><span class="tab-icon">üìä</span>Health</div>
        </div>
    </div>
    <div class="modal-overlay" id="appt-modal"><div class="modal"><div class="modal-header"><span class="modal-title">Book Appointment</span><button class="modal-close" onclick="close('appt')">&times;</button></div><div class="modal-body"><div class="form-group"><label class="form-label">Type</label><select class="form-select" id="aType"><option>GP Consultation</option><option>Blood Test</option><option>Prescription Review</option><option>Annual Check-up</option></select></div><div class="form-group"><label class="form-label">Date</label><input type="date" class="form-input" id="aDate"></div><div class="form-group"><label class="form-label">Time</label><select class="form-select" id="aTime"><option>9:00 AM</option><option>10:00 AM</option><option>2:00 PM</option></select></div></div><div class="modal-footer"><button class="btn btn-secondary" onclick="close('appt')">Cancel</button><button class="btn btn-primary" onclick="saveAppt()">Book</button></div></div></div>
    <div class="modal-overlay" id="rx-modal"><div class="modal"><div class="modal-header"><span class="modal-title">Order Prescription</span><button class="modal-close" onclick="close('rx')">&times;</button></div><div class="modal-body"><div class="form-group"><label class="form-label">Medication</label><select class="form-select"><option>Amlodipine 5mg</option><option>Metformin 500mg</option><option>Atorvastatin 20mg</option></select></div><div class="form-group"><label class="form-label">Quantity</label><input type="number" class="form-input" value="56"></div></div><div class="modal-footer"><button class="btn btn-secondary" onclick="close('rx')">Cancel</button><button class="btn btn-primary" onclick="alert('Prescription ordered!');close('rx')">Order</button></div></div></div>
    <div class="modal-overlay" id="measure-modal"><div class="modal"><div class="modal-header"><span class="modal-title">Log Measurement</span><button class="modal-close" onclick="close('measure')">&times;</button></div><div class="modal-body"><div class="form-group"><label class="form-label">Type</label><select class="form-select" id="mType"><option>Blood Pressure</option><option>Heart Rate</option><option>Blood Glucose</option><option>Weight</option></select></div><div class="form-group"><label class="form-label">Value</label><input type="text" class="form-input" id="mVal" placeholder="120/80 or 72"></div></div><div class="modal-footer"><button class="btn btn-secondary" onclick="close('measure')">Cancel</button><button class="btn btn-primary" onclick="saveMeasure()">Save</button></div></div></div>
    <div class="modal-overlay" id="rec-modal"><div class="modal"><div class="modal-header"><span class="modal-title">Add Record</span><button class="modal-close" onclick="close('rec')">&times;</button></div><div class="modal-body"><div class="form-group"><label class="form-label">Type</label><select class="form-select" id="rType"><option>Letter</option><option>Test Result</option><option>Prescription</option><option>Scan</option></select></div><div class="form-group"><label class="form-label">Title</label><input type="text" class="form-input" id="rTitle"></div><div class="form-group"><label class="form-label">Date</label><input type="date" class="form-input" id="rDate"></div></div><div class="modal-footer"><button class="btn btn-secondary" onclick="close('rec')">Cancel</button><button class="btn btn-primary" onclick="saveRec()">Save</button></div></div></div>
    <div class="modal-overlay" id="med-modal"><div class="modal"><div class="modal-header"><span class="modal-title">Add Medication</span><button class="modal-close" onclick="close('med')">&times;</button></div><div class="modal-body"><div class="form-group"><label class="form-label">Name</label><input type="text" class="form-input" id="medName"></div><div class="form-group"><label class="form-label">Purpose</label><input type="text" class="form-input" id="medPurpose"></div><div class="form-group"><label class="form-label">Dosage</label><input type="text" class="form-input" id="medDose"></div><div class="form-group"><label class="form-label">Time</label><input type="time" class="form-input" id="medTime"></div></div><div class="modal-footer"><button class="btn btn-secondary" onclick="close('med')">Cancel</button><button class="btn btn-primary" onclick="saveMed()">Add</button></div></div></div>
    <script>
        let data={user:null,meds:[],appts:[],recs:[],measures:[]};
        const DEMO={meds:[{id:1,n:'Amlodipine 5mg',p:'Blood Pressure',d:'1 tablet',t:'08:00',tk:1},{id:2,n:'Metformin 500mg',p:'Diabetes',d:'1 tablet',t:'12:00',tk:0},{id:3,n:'Atorvastatin 20mg',p:'Cholesterol',d:'1 tablet',t:'21:00',tk:0}],appts:[{id:1,t:'GP Consultation',d:'2026-02-20',tm:'10:30'},{id:2,t:'Blood Test',d:'2026-03-05',tm:'14:00'}],recs:[{ty:'Letter',ti:'Cardiology Referral',da:'2026-02-15'},{ty:'Test Result',ti:'Blood Panel',da:'2026-02-10'}],measures:[{v:'128/82'},{v:'132/85'},{v:'125/80'},{v:'130/84'},{v:'128/82'},{v:'135/86'},{v:'122/78'}]};
        
        function init(){
            const s=localStorage.getItem('healthhub');
            if(s){data=JSON.parse(s);if(data.user)showApp()}
            else{data={user:null,...DEMO,meds:DEMO.meds.map(m=>({...m,tk:0}))};render()}
        }
        function login(){
            const e=document.getElementById('email').value;
            if(e){data.user={name:e.split('@')[0],e};save();showApp()}
        }
        function guest(){data.user={name:'Guest',e:'guest'};save();showApp()}
        function save(){localStorage.setItem('healthhub',JSON.stringify(data));render()}
        function showApp(){document.getElementById('login').style.display='none';document.getElementById('app').style.display='block';render()}
        function show(id){document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));document.getElementById(id).classList.add('active');document.querySelectorAll('.tab-item').forEach(t=>t.classList.remove('active'));event.target.closest('.tab-item').classList.add('active')}
        function open(id){document.getElementById(id+'-modal').classList.add('active')}
        function close(id){document.getElementById(id+'-modal').classList.remove('active')}
        function toggle(id){const m=data.meds.find(x=>x.id===id);if(m){m.tk=m.tk?0:1;save()}}
        function saveAppt(){data.appts.push({id:Date.now(),t:document.getElementById('aType').value,d:document.getElementById('aDate').value,tm:document.getElementById('aTime').value});save();close('appt')}
        function saveRec(){data.recs.push({id:Date.now(),ty:document.getElementById('rType').value,ti:document.getElementById('rTitle').value,da:document.getElementById('rDate').value});save();close('rec')}
        function saveMed(){data.meds.push({id:Date.now(),n:document.getElementById('medName').value,p:document.getElementById('medPurpose').value,d:document.getElementById('medDose').value,t:document.getElementById('medTime').value,tk:0});save();close('med')}
        function saveMeasure(){data.measures.unshift({v:document.getElementById('mVal').value,d:new Date().toISOString().split('T')[0]});save();close('measure')}
        function render(){
            document.getElementById('sAppt').textContent=data.appts.length;
            document.getElementById('sMeds').textContent=data.meds.length;
            document.getElementById('sRec').textContent=data.recs.length;
            const t=data.meds.filter(m=>m.tk).length;
            document.getElementById('sPill').textContent=data.meds.length?Math.round(t/data.meds.length*100)+'%':'--';
            document.getElementById('userName').textContent=data.user?.name||'Guest';
            document.getElementById('avatar').textContent=(data.user?.name||'G').charAt(0);
            document.getElementById('todayMeds').innerHTML=data.meds.slice(0,3).map(m=>`<div class="med-item"><div class="med-info"><h4>${m.n}</h4><p>${m.d} ‚Ä¢ ${m.t}</p></div><div class="status-dot ${m.tk?'taken':''}" onclick="toggle(${m.id})"></div></div>`).join('');
            document.getElementById('allMeds').innerHTML=data.meds.map(m=>`<div class="med-item"><div class="med-info"><h4>${m.n}</h4><p>${m.p} ‚Ä¢ ${m.d}</p></div><div class="status-dot ${m.tk?'taken':''}" onclick="toggle(${m.id})"></div></div>`).join('');
            document.getElementById('upAppts').innerHTML=data.appts.map(a=>`<div class="appt-card"><div class="appt-date">üìÖ ${a.d} ‚Ä¢ ${a.tm}</div><div class="appt-type">${a.t}</div></div>`).join('');
            document.getElementById('allRecs').innerHTML=data.recs.map(r=>`<div class="record-item"><div class="record-type">${r.ty}</div><div class="record-title">${r.ti}</div><div class="record-date">${r.da}</div></div>`).join('');
            const bp=data.measures.slice(0,7).reverse();
            document.getElementById('bpChart').innerHTML=bp.map(m=>{const s=parseInt(m.v.split('/')[0]);return`<div class="bar" style="height:${Math.min(100,s-60)*2}%" data-v="${m.v}"></div>`}).join('');
            document.getElementById('healthMet').innerHTML=`<div class="metric"><span>Blood Pressure</span><span><span class="badge badge-good">${data.measures[0]?.v||'--'}</span></span></div><div class="metric"><span>Heart Rate</span><span><span class="badge badge-good">72 bpm</span></span></div><div class="metric"><span>Weight</span><span><span class="badge badge-good">78 kg</span></span></div>`;
        }
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();deferredPrompt=e;document.getElementById('pwaBanner').classList.add('show')});
        function installPWA(){if(deferredPrompt){deferredPrompt.prompt();deferredPrompt.userChoice.then(r=>{if(r.response==='accepted')document.getElementById('pwaBanner').classList.remove('show')})}}
        if('serviceWorker'in navigator)navigator.serviceWorker.register('sw.js');
        init();
    </script>
</body>
</html>
